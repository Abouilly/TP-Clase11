(this["webpackJsonp@galicia/react-nave"]=this["webpackJsonp@galicia/react-nave"]||[]).push([[19],{477:function(e,r,t){},504:function(e,r,t){"use strict";t.r(r),t.d(r,"FormCuil",(function(){return s}));var i=t(0),a=t.n(i),o=t(8),u=t(50),l=(t(477),t(9)),n=t(3);const s=e=>{var r,t,s,d;const c=e.formCuil.value||"",[m,p]=Object(i.useState)(c),[v,f]=Object(i.useState)({error:!1,helper:""}),C=Object(i.useRef)(),h=Object(i.useContext)(o.b),[g,b]=(h.stateForms.isRecaptchaDisable,Object(i.useState)(null)),[S,E]=Object(i.useState)(null),y=Object(i.useRef)(),[j,O]=Object(i.useState)(!1),[q,F]=Object(i.useState)(!1);Object(i.useEffect)(()=>{p(e.formCuil.value)},[c]),Object(i.useEffect)(()=>{if(f({error:!1,helper:e.formCuil.help}),!e.isInEditor){var r,t;h.addMethodValidate(w),h.addErrorState({id:e.id,isInError:!1}),h.addErrorToCurrentStep({id:e.id,isInError:v.error}),h.addMethodValidateToCurrentStep(w);const a=h.getPreviusValue(null===(r=e.formCuil)||void 0===r?void 0:r.name);var i;if(p(a||""),"true"==(null===(t=e.formCuil.require)||void 0===t?void 0:t.require))h.addRequiredField(null===(i=e.formCuil)||void 0===i?void 0:i.name)}},[]);const T=async r=>{var t;const i={error:!1,helper:e.formCuil.help};(e=>{let r=Number(e),t=!0;return t=r>=305e8&&r<=309e8||r>=33e9&&r<=33999999999||r>=34e9&&r<=34999999999||r>=2e10&&r<=20999999999||r>=23e9&&r<=23999999999||r>=24e9&&r<=24999999999||r>=27e9&&r<=27999999999,t})(r)||(i.error=!0,i.helper=e.formCuil.generalerrormsg),"true"!=(null===(t=e.formCuil.require)||void 0===t?void 0:t.require)||r||(i.error=!0,i.helper=e.formCuil.require.requireerrormsg),r.length<11&&r&&(i.error=!0,i.helper=e.formCuil.generalerrormsg,q&&F(!1));let a=y.current.querySelector('input[name="vc_status"]');"1"===(null===a||void 0===a?void 0:a.value)&&11===r.length&&(i.error=!0,i.helper=e.formCuil.msgErrorAfipCuil),f(i),h.updateErrorState(e.id,i.error),h.updateCurrentErrorState(e.id,i.error),i.error||!e.formCuil.enableService||a||await k(r)},w=()=>T(C.current.value),k=async r=>{let t="",i={};if(h.stateForms.getRecaptchaToken){const e=Object(l.e)();i=(null===e||void 0===e?void 0:e.version3)&&{recaptchaSite:e.site}||{},t=await h.stateForms.getRecaptchaToken(),h.stateForms.resetRecaptchaToken()}O(!0),h.updateErrorState(e.id,!0),h.updateCurrentErrorState(e.id,!0),fetch("/services/cuitvalidator",{method:"POST",headers:{"Content-Type":"application/json",siteV3:"sitev3",...i},body:JSON.stringify({cuit:r,channel:"web",business:"web",recaptcha:t})}).then(e=>{if(!e.ok)throw new Error("HTTP error! Status: "+e.status);return e.json()}).then(r=>{0===r.status||-1===r.status?(E(r),h.updateErrorState(e.id,!1),h.updateCurrentErrorState(e.id,!1),f({error:!1,helper:e.formCuil.msgValidatedCuil}),F(!0),-1===r.status&&Object(n.c)(500,"cuil afip service not connection")):(E({status:1}),f({error:!0,helper:e.formCuil.msgErrorAfipCuil}),h.updateErrorState(e.id,!0),h.updateCurrentErrorState(e.id,!0),Object(n.c)(500,"cuil afip service not validated")),O(!1)}).catch(r=>{Object(n.c)(500,"cuil service not connection"),O(!1),E({status:-1}),h.updateErrorState(e.id,!1),h.updateCurrentErrorState(e.id,!1),f({error:!1,helper:e.formCuil.msgValidatedCuil}),F(!0)})};return a.a.createElement("div",{ref:y},"personaFisica"===g&&e.formCuil.typPersonaFisica&&a.a.createElement("input",{name:"tpy-persona-form-dinamic",type:"hidden",value:e.formCuil.typPersonaFisica}),"personaJuridica"===g&&e.formCuil.typPersonaJuridica&&a.a.createElement("input",{name:"tpy-persona-form-dinamic",type:"hidden",value:e.formCuil.typPersonaJuridica}),S&&Object.entries(S).map(([e,r],t)=>a.a.createElement("input",{key:t,type:"hidden",name:"vc_"+e,value:r})),a.a.createElement(u.a,{id:e.formCuil.id,ref:C,require:null===(r=e.formCuil.require)||void 0===r?void 0:r.require,type:"number",name:null===(t=e.formCuil)||void 0===t?void 0:t.name,label:null===(s=e.formCuil)||void 0===s?void 0:s.label,message:v.error?v.helper:j?e.formCuil.msgLoadingService:q?e.formCuil.msgValidatedCuil:e.formCuil.help,error:v.error,onChange:r=>{var t,i;let a=r.target.value;"number"===(null===(t=e.formCuil)||void 0===t?void 0:t.type)&&(a=a.replace(/\D/g,""));let o=(e=>{let r=Number(e);return r>=2e10&&r<=20999999999||r>=23e9&&r<=23999999999||r>=24e9&&r<=24999999999||r>=27e9&&r<=27999999999?"personaFisica":(r>=305e8&&r<=30999999999||r>=33e9&&r<=33999999999||r>=34e9&&r<=34999999999)&&"personaJuridica"})(a);b(o||null),a.length<11&&E(null),p(a),T(a),h.saveData([{[null===(i=e.formCuil)||void 0===i?void 0:i.name]:r.target.value}])},value:m,maxLength:11,minLength:11,onBlur:r=>{var t;""===r.target.value&&"false"==(null===(t=e.formCuil.require)||void 0===t?void 0:t.require)&&f({error:!1,helper:e.formCuil.help}),"date"!==e.formCuil.type||r.target.value||f({error:!0,helper:e.formCuil.require.requireerrormsg})},placeholder:null===(d=e.formCuil)||void 0===d?void 0:d.placeholder,$success:q,isLoading:j}))};r.default=s}}]);
//# sourceMappingURL=19.68e6a21f.chunk.js.map